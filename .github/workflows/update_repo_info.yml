# action to update repo info using scripts/parse_gh_api.py
# this action is triggered by both the push event and a cron job (every week)
# uses the action EndBug/add-and-commit@v9

name: Update Repo Info

on:
  push:
    branches:
      - main
  schedule:
    - cron: '0 0 * * 0'
  workflow_dispatch:

jobs:
    update_repo_info:
        runs-on: ubuntu-latest
        steps:
        - name: Checkout
          uses: actions/checkout@v2
        - name: Set up Python
          uses: actions/setup-python@v2
          with:
            python-version: '3.x'
        - run: |
            pip install requests
            python scripts/parse_gh_api.py
        - name: Update Repo Info
          uses: EndBug/add-and-commit@v9
          with:
            message: "Update repo info"
            add: "docs/assets/cards/repos.json"
            committer_name: "GitHub Actions"
            committer_email: "actions@github.com"
